{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/rahulbhate/projects/react-next-serversiderendering/pages/secret.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport { Cookies } from 'react-cookie';\nimport { handleAuthSSR } from '../utils/auth';\nvar serverUrl = 'http://localhost:8080'; // set up cookies\n\nvar cookies = new Cookies();\n\nvar Secret =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Secret, _React$Component);\n\n  function Secret() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Secret);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Secret)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"onPingCall\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        var token, res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                token = cookies.get('token');\n                console.log(token);\n                _context.prev = 2;\n                _context.next = 5;\n                return axios.get(serverUrl + '/logout', {\n                  headers: {\n                    Authorization: token\n                  }\n                });\n\n              case 5:\n                res = _context.sent;\n                console.log(res.data.msg);\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](2);\n                console.log(_context.t0.response.data.msg);\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 9]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    return _this;\n  }\n\n  _createClass(Secret, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 27\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 28\n        },\n        __self: this\n      }, \"Secret page\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 29\n        },\n        __self: this\n      }, \"Only accessible via a valid JWT\"), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 30\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: function onClick(e) {\n          return _this2.onPingCall(e);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 31\n        },\n        __self: this\n      }, \"Logout\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 32\n        },\n        __self: this\n      }, \"Check console for response\"));\n    }\n  }]);\n\n  return Secret;\n}(React.Component); // Server-Side Rendering\n\n\nSecret.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(ctx) {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return handleAuthSSR(ctx);\n\n          case 2:\n            return _context2.abrupt(\"return\", {});\n\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nexport default Secret;","map":{"version":3,"sources":["/Users/rahulbhate/projects/react-next-serversiderendering/pages/secret.js"],"names":["React","axios","Cookies","handleAuthSSR","serverUrl","cookies","Secret","e","token","get","console","log","headers","Authorization","res","data","msg","response","onPingCall","Component","getInitialProps","ctx"],"mappings":";;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,cAAxB;AACA,SAASC,aAAT,QAA8B,eAA9B;AAEA,IAAMC,SAAS,GAAG,uBAAlB,C,CAEA;;AACA,IAAMC,OAAO,GAAG,IAAIH,OAAJ,EAAhB;;IAEMI,M;;;;;;;;;;;;;;;;;;;;;;;+BACS,iBAAOC,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACLC,gBAAAA,KADK,GACGH,OAAO,CAACI,GAAR,CAAY,OAAZ,CADH;AAEfC,gBAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ;AAFe;AAAA;AAAA,uBAISP,KAAK,CAACQ,GAAN,CAAUL,SAAS,GAAG,SAAtB,EAAiC;AACjDQ,kBAAAA,OAAO,EAAE;AAAEC,oBAAAA,aAAa,EAAEL;AAAjB;AADwC,iBAAjC,CAJT;;AAAA;AAIHM,gBAAAA,GAJG;AAOTJ,gBAAAA,OAAO,CAACC,GAAR,CAAYG,GAAG,CAACC,IAAJ,CAASC,GAArB;AAPS;AAAA;;AAAA;AAAA;AAAA;AASTN,gBAAAA,OAAO,CAACC,GAAR,CAAY,YAAIM,QAAJ,CAAaF,IAAb,CAAkBC,GAA9B;;AATS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;;6BAaJ;AAAA;;AACP,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAFF,EAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,EAIE;AAAQ,QAAA,OAAO,EAAE,iBAACT,CAAD;AAAA,iBAAO,MAAI,CAACW,UAAL,CAAgBX,CAAhB,CAAP;AAAA,SAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF,EAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCALF,CADF;AASD;;;;EAxBkBP,KAAK,CAACmB,S,GA2B3B;;;AACAb,MAAM,CAACc,eAAP;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAyB,kBAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAKjBlB,aAAa,CAACkB,GAAD,CALI;;AAAA;AAAA,8CAQhB,EARgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAzB;;AAAA;AAAA;AAAA;AAAA;;AAWA,eAAef,MAAf","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport { Cookies } from 'react-cookie';\nimport { handleAuthSSR } from '../utils/auth';\n\nconst serverUrl = 'http://localhost:8080';\n\n// set up cookies\nconst cookies = new Cookies();\n\nclass Secret extends React.Component {\n  onPingCall = async (e) => {\n    const token = cookies.get('token');\nconsole.log(token);\n    try {\n      const res = await axios.get(serverUrl + '/logout', {\n        headers: { Authorization: token },\n      });\n      console.log(res.data.msg);\n    } catch (err) {\n      console.log(err.response.data.msg);\n    }\n  };\n\n  render() {\n    return (\n      <div>\n        <h2>Secret page</h2>\n        <p>Only accessible via a valid JWT</p>\n        <br />\n        <button onClick={(e) => this.onPingCall(e)}>Logout</button>\n        <p>Check console for response</p>\n      </div>\n    );\n  }\n}\n\n// Server-Side Rendering\nSecret.getInitialProps = async (ctx) => {\n  // Must validate JWT\n  // If the JWT is invalid it must redirect\n  // back to the main page. You can do that\n  // with Router from 'next/router\n  await handleAuthSSR(ctx);\n\n  // Must return an object\n  return {};\n};\n\nexport default Secret;\n"]},"metadata":{},"sourceType":"module"}