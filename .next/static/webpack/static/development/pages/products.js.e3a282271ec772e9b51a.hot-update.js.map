{"version":3,"file":"static/webpack/static/development/pages/products.js.e3a282271ec772e9b51a.hot-update.js","sources":["webpack:///./pages/products.js","webpack:///./src/components/List/List.js","webpack:///./src/components/List/useInfiniteScroll.js","webpack:///./src/components/ProductCard/ProductCard.js","webpack:///./utils/withAuthInitial.js"],"sourcesContent":["// This is the Link API\nimport React, { useState, useRef, useEffect } from 'react';\nimport fetch from 'isomorphic-unfetch';\nimport Button from '../src/components/Button/Button';\nimport List from '../src/components/List/List';\nimport useInfiniteScroll from '../src/components/List/useInfiniteScroll';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport withAuthInitial from '../utils/withAuthInitial';\nimport ProductCard from '../src/components/ProductCard/ProductCard';\n\nfunction Products({ storeProducts }) {\n  const [start,setStart] = useState(3);\n  const [limit] = useState(3);\n  const [listItems, setListItems] = useState(storeProducts);\n  const [isFetching, setIsFetching] = useInfiniteScroll(fetchMoreListItems);\n  function fetchMoreListItems() {\n    let newStart = start+limit;\n    setStart(newStart)\n    fetch(`http://localhost:8000/products?start=${start}&limit=${limit}`)\n    .then((data)=>{\n      setTimeout(() => {\n        setListItems((prevState) => [\n          ...prevState,\n          data.json(),\n          \n        ]);\n        setIsFetching(false);\n      }, 1000);\n    }).catch((error)=>{\n      console.log(error);\n    })\n    \n  }\n  return (\n    <>\n      <div className=\"container\">\n        <div className=\"row\">\n          <div className=\"card-deck\">\n            {listItems.map((product, index) => {\n              return (\n                <div className=\"col-md-4\">\n                  <ProductCard product={product} />\n                </div>\n              );\n            })}\n            {isFetching && 'Fetching more list items...'}\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n\nProducts.getInitialProps = async () => {\n  let start = 0;\n  let limit = 3;\n  const respon = await fetch(\n    `http://localhost:8000/products?start=${start}&limit=${limit}`,\n  );\n  const data = await respon.json();\n  const error = 'Module Not Found';\n  if (data) {\n    return { storeProducts: data };\n  } else {\n    return { storeProducts: error };\n  }\n};\n\nexport default withAuthInitial(Products);\n","import React, { useState, useEffect } from 'react';\nimport useInfiniteScroll from './useInfiniteScroll';\n\nconst List = () => {\n  const [start, setStart] = useState(1);\n  const [limit, setLimit] = useState(5);\n  const [listItems, setListItems] = useState([]);\n  const [isFetching, setIsFetching] = useInfiniteScroll(fetchMoreListItems);\n\n  function fetchMoreListItems() {\n    alert('called');\n    const respon = fetch(\n      `http://localhost:8000/products?start=${start}&limit=${limit}`,\n    );\n    console.log(respon);\n    setTimeout(() => {\n      setListItems((prevState) => [\n        ...prevState,\n        ...Array.from(Array(20).keys(), (n) => n + prevState.length + 1),\n      ]);\n      setIsFetching(false);\n    }, 2000);\n  }\n\n  return (\n    <>\n      <ul className=\"list-group mb-2\">\n        {listItems.map((listItem, index) => (\n          <li className=\"list-group-item\">List Item {listItem}</li>\n        ))}\n      </ul>\n      {isFetching && 'Fetching more list items...'}\n    </>\n  );\n};\n\nexport default List;\n","import { useState, useEffect } from 'react';\n\nconst useInfiniteScroll = (callback) => {\n  const [isFetching, setIsFetching] = useState(false);\n\n  useEffect(() => {\n    window.addEventListener('scroll', handleScroll);\n    return () => window.removeEventListener('scroll', handleScroll);\n  }, []);\n\n  useEffect(() => {\n    if (!isFetching) return;\n    callback(() => {\n      console.log('called back');\n    });\n  }, [isFetching]);\n\n  function handleScroll() {\n    if (\n      window.innerHeight + document.documentElement.scrollTop !==\n        document.documentElement.offsetHeight ||\n      isFetching\n    )\n      return;\n    setIsFetching(true);\n  }\n\n  return [isFetching, setIsFetching];\n};\n\nexport default useInfiniteScroll;\n","import React, { useState } from 'react';\nimport Button from '../../components/Button/Button';\nconst ProductCard = (props) => {\n  const [quantity, setQuantity] = useState(1);\n  function handleAddToCart() {\n    let cart = localStorage.getItem('cart')\n      ? JSON.parse(localStorage.getItem('cart'))\n      : {};\n    let id = props.product.SKU;\n    let title = props.product.title;\n    let price = props.product.price;\n    cart[id] = cart[id] ? cart[id] : 0;\n    let qty = cart[id] + quantity;\n    if (props.product.available_quantity < qty) {\n      cart[id] = props.product.available_quantity;\n    } else {\n      cart[id] = qty;\n      cart[title] = title;\n      cart[price] = price;\n    }\n    localStorage.setItem('cart', JSON.stringify(cart));\n  }\n\n  return (\n    <>\n      <div>\n        <img\n          src={`/static/products/product-${props.product.image}.png`}\n          className=\"card-img-top\"\n        />\n        <div className=\"card-body\">\n          <h4 key={props.product.id} className=\"card-title\">\n            {props.product.title}\n          </h4>\n          <Button\n            type={'primary'}\n            title={'Add To Cart'}\n            onClick={handleAddToCart}\n          />\n          <p className=\"card-text\">{props.product.price}</p>\n          <p>{props.product.GST}</p>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default ProductCard;\n","import React, { Component } from 'react';\nimport Router from 'next/router';\nimport AuthHelperMethods from './AuthHelperMethods';\n\nexport default function withAuthInitial(AuthComponent) {\n  const Auth = new AuthHelperMethods();\n  return class Authenticated extends Component {\n    static async getInitialProps(ctx) {\n      // Check if Page has a `getInitialProps`; if so, call it.\n      console.log('withAuthInitial method called');\n      const pageProps =\n        AuthComponent.getInitialProps &&\n        (await AuthComponent.getInitialProps(ctx));\n      // Return props.\n      return { ...pageProps };\n    }\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        isLoading: true,\n      };\n    }\n\n    componentDidMount() {\n      if (!Auth.loggedIn()) {\n        Router.push('/login');\n      }\n      this.setState({ isLoading: false });\n    }\n\n    render() {\n      return (\n        <div>\n          {this.state.isLoading ? (\n            <div>LOADING....</div>\n          ) : (\n            <AuthComponent {...this.props} auth={Auth} />\n          )}\n        </div>\n      );\n    }\n  };\n}\n"],"mappings":"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","sourceRoot":""}