{"version":3,"file":"static/webpack/static\\development\\pages\\secret.js.adb412b32e53cd58a911.hot-update.js","sources":["webpack:///./pages/secret.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport withAuth from '../utils/withAuth';\r\nimport { Router } from 'next/router';\r\nimport decode from 'jwt-decode';\r\nconst serverUrl = 'http://localhost:8080';\r\n\r\nfunction Secret() {\r\n  const [isAuthenticated, setAuthenticated] = useState(true);\r\n  const [clientToken, setToken] = useState();\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('rememberMe');\r\n    console.log(token);\r\n\r\n    if (token) {\r\n      const decoded = decode(token);\r\n      setAuthenticated(true);\r\n      setToken(token);\r\n      console.log(clientToken);\r\n      console.log(decoded);\r\n      if (decoded.exp < Date.now() / 1000) {\r\n        setAuthenticated(false);\r\n        localStorage.removeItem('rememberMe');\r\n      }\r\n    } else {\r\n      setAuthenticated(false);\r\n      //Router.push('/login');\r\n    }\r\n    console.log('useEffect hook called');\r\n  });\r\n  const logout = async () => {\r\n    await axios\r\n      .post(serverUrl + '/logout', {})\r\n      .then((res) => {\r\n        console.log(res);\r\n        setToken('');\r\n        localStorage.removeItem('rememberMe');\r\n        console.log('token has been removed');\r\n      })\r\n      .then((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n  return isAuthenticated ? (\r\n    <div>\r\n      {' '}\r\n      <h3>This is secret page</h3>\r\n      <button onClick={logout}>Logout</button>\r\n    </div>\r\n  ) : (\r\n    <div>\r\n      <h3>You are not authorized user</h3>\r\n    </div>\r\n  );\r\n}\r\nexport default withAuth(Secret);\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAYA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;;;;A","sourceRoot":""}